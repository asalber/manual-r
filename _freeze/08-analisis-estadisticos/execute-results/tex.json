{
  "hash": "4b04942841965a5c5ea86e60f2af5216",
  "result": {
    "markdown": "---\ntitle: Análisis Estadísticos\nlang: es\n---\n\n\n\n\n\nEl tipo de estudio estadístico más apropiado en cada caso depende de varios factores:\n\n- El objetivo del estudio.\n- El número de variables que intervienen.\n- El tipo de las variables dependientes e independientes.\n- La naturaleza de las observaciones (independientes o emparejadas).\n\nA continuación se presentan los estudios estadísticos más habituales en función de estos factores. La siguiente [tabla de resumen de contrastes de hipótesis más habituales](tablas/Tabla%20Resumen%20Contraste%20de%20Hip%C3%B3tesis.pdf) puede ayudar a identificar el más apropiado en cada caso.\n\n<table width=\"1054\" cellspacing=\"0\" cellpadding=\"5\" border=\"1\">\n<tbody>\n<tr>\n<td bgcolor=\"#6d9eeb\" width=\"95\">\n<p><strong>Variables independientes</strong></p>\n</td>\n<td bgcolor=\"#6d9eeb\" width=\"88\">\n<p><strong>Variable dependiente</strong></p>\n</td>\n<td bgcolor=\"#6d9eeb\" width=\"315\">\n<p><strong>Objetivo</strong></p>\n</td>\n<td bgcolor=\"#6d9eeb\" width=\"330\">\n<p><strong>Ejemplo</strong></p>\n</td>\n<td bgcolor=\"#6d9eeb\" width=\"174\">\n<p><strong>Contraste</strong></p>\n</td>\n</tr>\n<tr>\n<td rowspan=\"6\" width=\"95\" height=\"14\">\n<p>Ninguna<br /> (Una poblaci&oacute;n)</p>\n</td>\n<td rowspan=\"2\" width=\"88\">\n<p>Cuantitativa</p>\n</td>\n<td rowspan=\"2\" width=\"315\">\n<p>Contrastar la normalidad de una variable</p>\n</td>\n<td rowspan=\"2\" width=\"330\">\n<p>Comprobar si la nota de un examen tiene distribuci&oacute;n normal (forma de campana de Gauss)</p>\n</td>\n<td width=\"174\">\n<p>Komogorov-Smirnov<br /> (requiere muestras grandes)</p>\n</td>\n</tr>\n<tr>\n<td width=\"174\">\n<p>Shapiro-Willks</p>\n</td>\n</tr>\n<tr>\n<td width=\"88\">\n<p>Cuantitativa normal</p>\n</td>\n<td width=\"315\">\n<p>Contrastar si la media poblacional de una variable tiene un valor determinado</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si la nota media de un examen es 5</p>\n</td>\n<td width=\"174\">\n<p>Test T para la media de una poblaci&oacute;n</p>\n</td>\n</tr>\n<tr>\n<td width=\"88\">\n<p>Cuantitativa o cualitativa ordinal</p>\n</td>\n<td width=\"315\">\n<p>Contrastar si la mediana poblacional de una variable tiene un valor determinado</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si la calificaci&oacute;n mediana de un examen es Aprobado</p>\n</td>\n<td width=\"174\">\n<p>Test para la mediana de una poblaci&oacute;n</p>\n</td>\n</tr>\n<tr>\n<td width=\"88\">\n<p>Cualitativa (2 categor&iacute;as)</p>\n</td>\n<td width=\"315\">\n<p>Contrastar si la proporci&oacute;n poblacional de una de las categor&iacute;as tiene un valor determinado</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si la proporci&oacute;n de aprobados es de la mitad (o que el porcentaje es 50%)</p>\n</td>\n<td width=\"174\">\n<p>Test Binomial</p>\n</td>\n</tr>\n<tr>\n<td width=\"88\">\n<p>Cualitativa</p>\n</td>\n<td width=\"315\">\n<p>Contrastar si las proporciones de cada una de las categor&iacute;as tienen un valor determinado</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si las proporciones de alumnos matriculados en ciencias, letras o mixtas son 0.5, 0.2 y 0.3 respectivamente</p>\n</td>\n<td width=\"174\">\n<p>Test Chi-cuadrado de bondad de ajuste</p>\n</td>\n</tr>\n<tr>\n<td rowspan=\"7\" width=\"95\" height=\"13\">\n<p>Una cualitativa con dos categor&iacute;as independientes <br /> (Dos poblaciones independientes)</p>\n</td>\n<td rowspan=\"3\" width=\"88\">\n<p>Cuantitativa normal</p>\n</td>\n<td width=\"315\">\n<p>Contrastar si hay diferencias entre las medias la variable dependiente en dos poblaciones independientes</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si el grupo de ma&ntilde;ana y el grupo de tarde han tenido notas medias diferentes</p>\n</td>\n<td width=\"174\">\n<p>Test T para la comparaci&oacute;n de medias de poblaciones independientes</p>\n</td>\n</tr>\n<tr>\n<td width=\"315\">\n<p>Contrastar si hay diferencias entre las varianzas de la variable dependiente en dos poblaciones independientes</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si hay diferencias entre la variabilidad de las notas del grupo de ma&ntilde;ana y el de tarde</p>\n</td>\n<td width=\"174\">\n<p>Test F de Fisher</p>\n</td>\n</tr>\n<tr>\n<td width=\"315\">\n<p>Contrastar si hay concordancia o acuerdo entre las dos variables</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si hay concordancia o acuerdo entre las notas que ponen dos profesores distintos para los mismos ex&aacute;menes</p>\n</td>\n<td width=\"174\">\n<p>Correlaci&oacute;n intraclase</p>\n</td>\n</tr>\n<tr>\n<td rowspan=\"2\" width=\"88\">\n<p>Cuantitativa o cualitativa ordinal</p>\n</td>\n<td width=\"315\">\n<p>Contrastar si hay diferencias entre las distribuciones de la variable dependiente en dos poblaciones independientes</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si el grupo de ma&ntilde;ana y el grupo de tarde han tenido calificaciones diferentes</p>\n</td>\n<td width=\"174\">\n<p>Test de la U de Mann-Whitney</p>\n</td>\n</tr>\n<tr>\n<td width=\"315\">\n<p>Contrastar si hay concordancia o acuerdo entre las dos variables</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si hay concordancia o acuerdo entre las calificaciones que ponen dos profesores distintos para los mismos ex&aacute;menes</p>\n</td>\n<td width=\"174\">\n<p>Kappa de Cohen</p>\n</td>\n</tr>\n<tr>\n<td rowspan=\"2\" width=\"88\">\n<p>Cualitativa</p>\n</td>\n<td width=\"315\">\n<p>Contrastar si hay relaci&oacute;n entre las dos variables o bien si hay diferencias entre las proporciones de las categor&iacute;as de la variable dependiente en las dos poblaciones definidas por las categor&iacute;as de la variable independiente</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si existe relaci&oacute;n entre los aprobados en una asignatura y el grupo al que pertenecen los alumnos, es decir, si la proporci&oacute;n de aprobados es diferente en dos grupos distintos.</p>\n</td>\n<td width=\"174\">\n<p>Test Chi-cuadrado <br /> (si no ha m&aacute;s del 20% de frecuencias esperadas menores que 5)<br /> Test exacto de Fisher</p>\n</td>\n</tr>\n<tr>\n<td width=\"315\">\n<p>Contrastar si hay concordancia o acuerdo entre las dos variables</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si hay concordancia o acuerdo entre la valoraci&oacute;n (aprobado o suspenso) que hacen dos profesores distintos para los mismos ex&aacute;menes</p>\n</td>\n<td width=\"174\">\n<p>Kappa de Cohen</p>\n</td>\n</tr>\n<tr>\n<td rowspan=\"3\" width=\"95\" height=\"14\">\n<p>Una cualitativa con dos categor&iacute;as relacionadas o pareadas<br /> (Dos poblaciones relacionadas o pareadas)</p>\n</td>\n<td width=\"88\">\n<p>Cuantitativa normal</p>\n</td>\n<td width=\"315\">\n<p>Contrastar si hay diferencias entre las medias de la variable dependiente en dos poblaciones relacionadas o pareadas</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si las notas medias de dos asignaturas cursadas por los mismos alumnos han sido diferentes o si las notas medias de un examen realizado al comienzo del curso (antes) y otro al final (despu&eacute;s) de una misma asignatura han sido diferentes</p>\n</td>\n<td width=\"174\">\n<p>Test T para la comparaci&oacute;n de medias de poblaciones relacionadas o pareadas</p>\n</td>\n</tr>\n<tr>\n<td width=\"88\">\n<p>Cuantitativa o cualitativa ordinal</p>\n</td>\n<td width=\"315\">\n<p>Contrastar si hay diferencias entre las distribuciones de la variable dependiente en dos poblaciones relacionadas o pareadas</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si las calificaciones de dos asignaturas cursadas por los mismos alumnos han sido diferentes</p>\n</td>\n<td width=\"174\">\n<p>Test de Wilcoxon</p>\n</td>\n</tr>\n<tr>\n<td width=\"88\">\n<p>Cualitativa con dos categor&iacute;as</p>\n</td>\n<td width=\"315\">\n<p>Contrastar si hay diferencias entre las proporciones de las categor&iacute;as de la variable dependiente en dos poblaciones relacionadas o pareadas</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si la proporci&oacute;n o el porcentaje de aprobados en un examen es distinta al comienzo y al final del curso</p>\n</td>\n<td width=\"174\">\n<p>Test de McNemar</p>\n</td>\n</tr>\n<tr>\n<td rowspan=\"4\" width=\"95\" height=\"14\">\n<p>Una cualitativa con dos o m&aacute;s categor&iacute;as</p>\n<p>independientes<br /> (Dos o m&aacute;s poblaciones independientes)</p>\n</td>\n<td width=\"88\">\n<p>Cuantitativa normal y homogeneidad de varianzas</p>\n</td>\n<td width=\"315\">\n<p>Contrastar si hay diferencias entre las medias la variable dependiente en cada una de las poblaciones definidas por las categor&iacute;as de la variable independiente</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si existen diferencias entre las notas medias de tres grupos distintos de clase.</p>\n</td>\n<td width=\"174\">\n<p>An&aacute;lisis de la Varianza de un factor (ANOVA)<br /> Si hay diferencias &gt; Test de Tukey o Bonferroni para la diferencia por pares</p>\n</td>\n</tr>\n<tr>\n<td width=\"88\">\n<p>Cuantitativa normal</p>\n</td>\n<td width=\"315\">\n<p>Contrastar si hay diferencias entre las varianzas de la variable dependiente en cada una de las poblaciones definidas por las categor&iacute;as de la variable independiente</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si la variabilidad de las notas de una asignatura es distinta en tres grupos diferentes de clase</p>\n</td>\n<td width=\"174\">\n<p>Prueba de Levene para la homogeneidad de varianzas</p>\n</td>\n</tr>\n<tr>\n<td width=\"88\">\n<p>Cuantitativa o cualitativa ordinal</p>\n</td>\n<td width=\"315\">\n<p>Contrastar si hay diferencias entre las distribuciones de la variable dependiente en cada una de las poblaciones definidas por las categor&iacute;as de la variable independiente</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si existen diferencias entre las calificaciones de tres grupos distintos de clase</p>\n</td>\n<td width=\"174\">\n<p>Test de Kruskal Wallis</p>\n</td>\n</tr>\n<tr>\n<td width=\"88\">\n<p>Cualitativa</p>\n</td>\n<td width=\"315\">\n<p>Contrastar si hay relaci&oacute;n entre las dos variables o bien si hay diferencias entre las proporciones de las categor&iacute;as de la variable dependiente en cada una de las poblaciones definidas por las categor&iacute;as de la variable independiente</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si existe relaci&oacute;n entre los aprobados en una asignatura y el grupo al que pertenecen los alumnos, es decir, si la proporci&oacute;n de aprobados es diferente en los distintos grupos.</p>\n</td>\n<td width=\"174\">\n<p>Test Chi-cuadrado <br /> (si no ha m&aacute;s del 20% de frecuencias esperadas menores que 5)<br /> Test exacto de Fisher</p>\n</td>\n</tr>\n<tr>\n<td rowspan=\"3\" width=\"95\" height=\"14\">\n<p>Una cualitativa con dos o m&aacute;s categor&iacute;as relacionadas <br /> (medidas repetidas)</p>\n</td>\n<td width=\"88\">\n<p>Cuantitativa normal</p>\n</td>\n<td width=\"315\">\n<p>Contrastar si hay diferencias entre las medias repetidas de la variable dependiente</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si hay diferencias entre las notas que otorgan varios profesores a un mismo examen</p>\n</td>\n<td width=\"174\">\n<p>An&aacute;lisis de la Varianza (ANOVA) de medidas repetidas de un factor</p>\n</td>\n</tr>\n<tr>\n<td width=\"88\">\n<p>Cuantitativa o cualitativa ordinal</p>\n</td>\n<td width=\"315\">\n<p>Contrastar si hay diferencias entre las medidas repetidas de la variable dependiente</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si hay diferencias entre las calificaciones que otorgan varios profesores a un mismo examen</p>\n</td>\n<td width=\"174\">\n<p>Test de Friedman</p>\n</td>\n</tr>\n<tr>\n<td width=\"88\">\n<p>Cualitativa</p>\n</td>\n<td width=\"315\">\n<p>Contrastar si hay diferencias entre las valoraciones repetidas de la variable dependiente</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si hay diferencias entre la valoraci&oacute;n (aprobado o suspenso) que hacen varios profesores de un mismo examen</p>\n</td>\n<td width=\"174\">\n<p>Regresi&oacute;n log&iacute;stica de medidas repetidas</p>\n</td>\n</tr>\n<tr>\n<td rowspan=\"4\" width=\"95\" height=\"13\">\n<p>Una cuantitativa normal</p>\n</td>\n<td rowspan=\"2\" width=\"88\">\n<p>Cuantitativa normal</p>\n</td>\n<td width=\"315\">\n<p>Contrastar si existe relaci&oacute;n lineal entre las dos variables</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si existe relaci&oacute;n entre las notas de dos asignaturas</p>\n</td>\n<td width=\"174\">\n<p>Correlaci&oacute;n de Pearson</p>\n</td>\n</tr>\n<tr>\n<td width=\"315\">\n<p>Construir un modelo predictivo que explique la variable dependiente en funci&oacute;n de la independiente</p>\n</td>\n<td width=\"330\">\n<p>Construir el modelo (funci&oacute;n de regresi&oacute;n) que mejor explique la relaci&oacute;n entre la nota de un examen y las horas dedicadas a su estudio</p>\n</td>\n<td width=\"174\">\n<p>Regresi&oacute;n simple (lineal o no lineal)</p>\n</td>\n</tr>\n<tr>\n<td width=\"88\">\n<p>Cuantitativa o cualitativa ordinal</p>\n</td>\n<td width=\"315\">\n<p>Contrastar si existe relaci&oacute;n lineal entre las dos variables</p>\n</td>\n<td width=\"330\">\n<p>Comprobar si existe relaci&oacute;n entre las calificaciones de dos asignaturas</p>\n</td>\n<td width=\"174\">\n<p>Correlaci&oacute;n de Spearman</p>\n</td>\n</tr>\n<tr>\n<td width=\"88\">\n<p>Cualitativa</p>\n</td>\n<td width=\"315\">\n<p>Construir un modelo predictivo que explique la variable dependiente en funci&oacute;n de la independiente</p>\n</td>\n<td width=\"330\">\n<p>Construir el modelo (funci&oacute;n log&iacute;stica) que mejor explique la relaci&oacute;n entre el resultado de un examen (aprobado o suspenso) y las horas dedicadas a su estudio</p>\n</td>\n<td width=\"174\">\n<p>Regresi&oacute;n log&iacute;stica simple</p>\n</td>\n</tr>\n</tbody>\n</table>\n\nLos ejemplos de los distintos test que se presentan a continuación se han realizado a partir del siguiente conjunto de datos que contiene las notas y calificaciones de un curso. El fichero con los datos puede descargarse aquí para reproducir los estudios: [notas-curso.csv](https://raw.githubusercontent.com/asalber/manual-r/master/datos/notas-curso.csv).\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-1_e19bd20098dbae57af9fa21078d2ffd6'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\ndf <- read.csv('https://raw.githubusercontent.com/asalber/manual-r/master/datos/notas-curso.csv')\nhead(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    sexo  turno grupo trabaja notaA notaB notaC notaD notaE calificacionA\n1  Mujer  Tarde     C       N   5.2   6.3   3.4   2.3   2.0      Aprobado\n2 Hombre Mañana     A       N   5.7   5.7   4.2   3.5   2.7      Aprobado\n3 Hombre Mañana     B       N   8.3   8.8   8.8   8.0   5.5      Aprobado\n4 Hombre Mañana     B       N   6.1   6.8   4.0   3.5   2.2      Aprobado\n5 Hombre Mañana     A       N   6.2   9.0   5.0   4.4   3.7      Aprobado\n6 Hombre Mañana     A       S   8.6   8.9   9.5   8.4   3.9      Aprobado\n  calificacionB calificacionC calificacionD calificacionE asinaturas.aprobadas\n1      Aprobado      Suspenso      Suspenso      Suspenso                    2\n2      Aprobado      Suspenso      Suspenso      Suspenso                    2\n3      Aprobado      Aprobado      Aprobado      Aprobado                    5\n4      Aprobado      Suspenso      Suspenso      Suspenso                    2\n5      Aprobado      Aprobado      Suspenso      Suspenso                    3\n6      Aprobado      Aprobado      Aprobado      Suspenso                    4\n  nota.media\n1        3.8\n2        4.3\n3        7.9\n4        4.5\n5        5.7\n6        7.8\n```\n:::\n:::\n\n\n\n## Una variable cuantitativa\n\n### Estudios descriptivos\n\n#### Estadísticos\n\n-   Tamaño muestral\n-   Media\n-   Desviación típica\n-   Mínimo, Máximo\n-   Cuartiles\n-   Coeficiente de asimetría\n-   Coeficiente de apuntamiento\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-2_2d7f6d73c247f4079cb67c93f876efc7'}\n\n```{.r .cell-code}\n# Tamaño muestral\nnrow(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 120\n```\n:::\n:::\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-3_7d96c8d41ac4623f441e245707b35c1f'}\n\n```{.r .cell-code}\n# Media\nmean(df$notaA, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 6.028333\n```\n:::\n:::\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-4_7ff9ab15e1ae8a0e455308bfa22472f2'}\n\n```{.r .cell-code}\n# Desviación típica\nsd(df$notaA, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.340524\n```\n:::\n:::\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-5_0a7ed498a0642c166bdb47a86652d6be'}\n\n```{.r .cell-code}\n# Min, max\nmin(df$notaA, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.5\n```\n:::\n:::\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-6_ca330ee7720a3f115b97b39d1e911155'}\n\n```{.r .cell-code}\nmax(df$notaA, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 9.3\n```\n:::\n:::\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-7_bbcf5c7451db866513ff877846174337'}\n\n```{.r .cell-code}\n# Cuartiles\nquantile(df$notaA, c(0.25, 0.5, 0.75), na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  25%   50%   75% \n5.100 5.900 6.825 \n```\n:::\n:::\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-8_b0db8a640238f8a9145de6ad2672328d'}\n\n```{.r .cell-code}\n# Coef. asimetría\nlibrary(moments)\nskewness(df$notaA, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1373915\n```\n:::\n:::\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-9_8d19f3b2d91974824ef5daa7d6e02aaa'}\n\n```{.r .cell-code}\n# Coef. apuntamiento\nkurtosis(df$notaA, na.rm = TRUE) - 3\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.102287\n```\n:::\n:::\n\n\n\n#### Gráficos\n\n-   Diagrama de barras (variables discretas)\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-10_e190bb1fd72cad6159a4131ac0ec5c5b'}\n\n```{.r .cell-code}\ndf %>% ggplot(aes(x = asinaturas.aprobadas)) + \n  geom_bar(fill=\"#00BFC4\") + \n  # Cambio de escala del eje X\n  scale_x_discrete(limits=0:5) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Continuous limits supplied to discrete scale.\ni Did you mean `limits = factor(...)` or `scale_*_continuous()`?\n```\n:::\n\n::: {.cell-output-display}\n![](08-analisis-estadisticos_files/figure-pdf/unnamed-chunk-10-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n-   Histograma\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-11_fc2d40f15439dad75694eb71ab29ef35'}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n# Límites de los intervalos\nbreaks = 0:10\n# Histograma de las notasA\ndf %>% ggplot(aes(x = notaA)) + \n  geom_histogram(breaks = breaks, fill=\"#00BFC4\") + \n  # Cambio de escala del eje X\n  scale_x_continuous(limits=c(0, 10), breaks = 0:10) \n```\n\n::: {.cell-output-display}\n![](08-analisis-estadisticos_files/figure-pdf/unnamed-chunk-11-1.pdf){fig-pos='H'}\n:::\n:::\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-12_3bd234f61683784df95280b9614519d9'}\n\n```{.r .cell-code}\n# Histograma de notasE\ndf %>% ggplot(aes(x = notaE)) + \n  geom_histogram(breaks = breaks, fill=\"#00BFC4\") + \n  # Cambio de escala del eje X\n  scale_x_continuous(limits=c(0, 10), breaks = 0:10) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 2 rows containing non-finite values (`stat_bin()`).\n```\n:::\n\n::: {.cell-output-display}\n![](08-analisis-estadisticos_files/figure-pdf/unnamed-chunk-12-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n-   Diagrama de líneas\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-13_64fa36fa7253408b3b330e24632d8783'}\n\n```{.r .cell-code}\n# Variables discretas\ndf %>% count(asinaturas.aprobadas) %>%\n  ggplot(aes(x = asinaturas.aprobadas, y = n)) +\n  geom_line(col=\"#00BFC4\") + \n  # Cambio de escala del eje X\n  scale_x_discrete(limits=0:5) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Continuous limits supplied to discrete scale.\ni Did you mean `limits = factor(...)` or `scale_*_continuous()`?\n```\n:::\n\n::: {.cell-output-display}\n![](08-analisis-estadisticos_files/figure-pdf/unnamed-chunk-13-1.pdf){fig-pos='H'}\n:::\n:::\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-14_146131429e94ee86dddab7476d01e324'}\n\n```{.r .cell-code}\n# Agrupación de datos en intervalos\ndf %>% ggplot(aes(x = notaA)) + \n  geom_freqpoly(breaks = breaks, col=\"#00BFC4\") + \n  # Cambio de escala del eje X\n  scale_x_continuous(limits=c(0, 10), breaks = 0:10) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 2 rows containing missing values (`geom_path()`).\n```\n:::\n\n::: {.cell-output-display}\n![](08-analisis-estadisticos_files/figure-pdf/unnamed-chunk-14-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n-   Diagrama de caja y bigotes\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-15_766d5d79eb0a7522415682617b6b74cf'}\n\n```{.r .cell-code}\ndf %>% ggplot(aes(x = notaA)) + \n  geom_boxplot(fill=\"#00BFC4\") +\n  # Cambio de escala del eje X\n  scale_x_continuous(limits=c(0, 10), breaks = 0:10)\n```\n\n::: {.cell-output-display}\n![](08-analisis-estadisticos_files/figure-pdf/unnamed-chunk-15-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n### Estudios inferenciales\n\n#### Test de normalidad de Shapiro-Wilk\n\n**Objetivo**: Comprobar la normalidad de la distribución.\n\n**Hipótesis nula**: La distribución es normal.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-16_6281d6e763f5ea9eef88b810887fdce8'}\n\n```{.r .cell-code}\nshapiro.test(df$notaA)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  df$notaA\nW = 0.99424, p-value = 0.907\n```\n:::\n:::\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-17_9ea07367e3774c52b91cc3e06c10b383'}\n\n```{.r .cell-code}\nshapiro.test(df$notaE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  df$notaE\nW = 0.92264, p-value = 4.065e-06\n```\n:::\n:::\n\n\n\n#### Test t para la media de una población\n\n**Objetivo**: Estimar la media de una variable o compararla con un valor\ndado *μ*<sub>0</sub>.\n\n**Requisitos**:\n\n-   Una variable cuantitativa.\n-   Distribución normal o tamaño muestral ≥ 30.\n\n**Hipótesis nula**: La media de la población es igual a *μ*<sub>0</sub>.\n\n**Ejemplo**: Comprobar si la nota media de un examen es diferente de 5.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-18_4c88bc0a648068e80bd6be9a5d1ec610'}\n\n```{.r .cell-code}\nt.test(df$notaA, mu = 5, alternative = \"two.sided\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne Sample t-test\n\ndata:  df$notaA\nt = 8.4033, df = 119, p-value = 1.08e-13\nalternative hypothesis: true mean is not equal to 5\n95 percent confidence interval:\n 5.786023 6.270643\nsample estimates:\nmean of x \n 6.028333 \n```\n:::\n:::\n\n\n\n## Una variable cualitativa\n\n### Estudios descriptivos\n\n#### Estadísticos\n\n-   Tamaños muestral\n-   Frecuencias muestrales\n-   Proporciones/porcentajes muestrales\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-19_34d48ca41fe7077f84a503051d9777eb'}\n\n```{.r .cell-code}\n# Tamaño muestral sin datos perdidos\nlength(na.omit(df$calificacionB))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 115\n```\n:::\n:::\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-20_fd8179efe568e11d3499fa173f338be8'}\n\n```{.r .cell-code}\n# Frecuencias\ntable(df$calificacionB)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nAprobado Suspenso \n      98       17 \n```\n:::\n:::\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-21_38943f701c8d03a479098a8eb87d0c82'}\n\n```{.r .cell-code}\n# Proporciones\ntable(df$calificacionB) / length(na.omit(df$calificacionB))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n Aprobado  Suspenso \n0.8521739 0.1478261 \n```\n:::\n:::\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-22_28d9c904e29ae0083e54889add02d956'}\n\n```{.r .cell-code}\n# Porcentajes\ntable(df$calificacionB) / length(na.omit(df$calificacionB)) * 100\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nAprobado Suspenso \n85.21739 14.78261 \n```\n:::\n:::\n\n\n\n#### Gráficos\n\n-   Diagrama de sectores\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-23_ff813168d7571e4d7da6ce11a79624f1'}\n\n```{.r .cell-code}\ndf %>% ggplot(aes(x = \"\", fill = calificacionA)) + \n  geom_bar() +\n  # Cambiar a coordenadas polares\n  coord_polar(theta = \"y\") +\n  # Eliminar ejes\n   theme_void()\n```\n\n::: {.cell-output-display}\n![](08-analisis-estadisticos_files/figure-pdf/unnamed-chunk-23-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n### Estudios inferenciales\n\n#### Test binomial para una proporción de una población\n\n**Objetivo**: Estimar la propoción de una categoría en una población o\ncompararla con un valor *p*<sub>0</sub>.\n\n**Requisitos**:\n\n-   One variable cualitativa\n\n**Hipótesis nula**: La proporción poblacional es igual a\n*p*<sub>0</sub>.\n\n**Ejemplo**: Comprobar si la proporción de aprobados es mayor de 0.5.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-24_d35254ade0c6b9534a975cfce1f0b059'}\n\n```{.r .cell-code}\nn <- nrow(df)\nfreq <- table(df$calificacionA)[\"Aprobado\"]\nbinom.test(freq, n, p = 0.5, alternative = \"greater\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tExact binomial test\n\ndata:  freq and n\nnumber of successes = 94, number of trials = 120, p-value = 1.57e-10\nalternative hypothesis: true probability of success is greater than 0.5\n95 percent confidence interval:\n 0.7123183 1.0000000\nsample estimates:\nprobability of success \n             0.7833333 \n```\n:::\n:::\n\n\n\n#### Test Z para la proporción de una población\n\n**Objetivo**: Estimar la propoción de una categoría en una población o\ncompararla con un valor *p*<sub>0</sub>.\n\n**Requisitos**:\n\n-   Una variable cualitativa\n-   Tamaño muestral >= 30\n\n**Observación**: Utiliza la aproximación normal de la distribución\nBinomal.\n\n**Ejemplo**: Comprobar si la proporción de aprobados es mayor de 0.5.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-25_9198b5bce35f5c0ca0b24d30f13277ce'}\n\n```{.r .cell-code}\nfreq <- table(df$calificacionA)[\"Aprobado\"]\nprop.test(freq, n, p = 0.7, alternative = \"greater\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\t1-sample proportions test with continuity correction\n\ndata:  freq out of n, null probability 0.7\nX-squared = 3.5813, df = 1, p-value = 0.02922\nalternative hypothesis: true p is greater than 0.7\n95 percent confidence interval:\n 0.7111099 1.0000000\nsample estimates:\n        p \n0.7833333 \n```\n:::\n:::\n\n\n\n## Dos variables: Variable dependiente cuantitativa y variable independiente culitativa con dos categorías o grupos\n\n### Estudios descriptivos\n\n#### Estadísticos\n\n-   Tamaño muestral de cada grupo\n-   Media de cada grupo\n-   Desviación típica de cada grupo\n-   Mínimo, Máximo de cada grupo\n-   Cuartiles de cada grupo\n-   Coeficiente de asimetría de cada grupo\n-   Coeficiente de apuntamiento de cada grupo\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-26_6b62de8c7d6386400b5ba8d036a8352f'}\n\n```{.r .cell-code}\n# Tamaño muestral de notaA según el sexo\ndf %>% group_by(sexo) %>% group_size()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 71 49\n```\n:::\n:::\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-27_1421e708dbc3e1f22a364971500668c8'}\n\n```{.r .cell-code}\n# Media, Desviación típica, Mín, Máx, Cuartiles, Coef. Asimetría y Coef. Apuntamiento\nlibrary(moments)\ndf %>% group_by(sexo) %>% summarize(Media = mean(notaA, na.rm=TRUE), Des.Tip = sd(notaA, na.rm = TRUE), Mín = min(notaA), Máx = max(notaA), C1 = quantile(notaA, 0.25, na.rm = TRUE), C2 = quantile(notaA, 0.5, na.rm = TRUE), C3 = quantile(notaA, 0.75, na.rm = TRUE), Coef.Asimetría = skewness(notaA, na.rm = TRUE), Coef.Apuntamiento = kurtosis(notaA, na.rm = TRUE) - 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 x 10\n  sexo   Media Des.Tip   Mín   Máx    C1    C2    C3 Coef.Asimetría\n  <chr>  <dbl>   <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>          <dbl>\n1 Hombre  6.12    1.23   3.5   9.3   5.3   6.1  6.85          0.249\n2 Mujer   5.89    1.49   2.5   9.3   5     5.7  6.8           0.135\n# i 1 more variable: Coef.Apuntamiento <dbl>\n```\n:::\n:::\n\n\n\n#### Gráficos\n\n-   Diagrama de cajas y bigotes\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-28_434a54f2a33c6972cdc47b3c4a57ba22'}\n\n```{.r .cell-code}\ndf %>% ggplot(aes(x = sexo, y = notaA, fill = sexo)) + \n  geom_boxplot() +\n  # Cambio de escala del eje y\n  scale_y_continuous(limits=c(0, 10), breaks = 0:10)\n```\n\n::: {.cell-output-display}\n![](08-analisis-estadisticos_files/figure-pdf/unnamed-chunk-28-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n-   Diagrama de violín\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-29_765cd8cc4ad0fc52bd09e817f9961f44'}\n\n```{.r .cell-code}\ndf %>% ggplot(aes(x = sexo, y = notaA, fill = sexo)) + \n  geom_violin() +\n  # Cambio de escala del eje y\n  scale_y_continuous(limits=c(0, 10), breaks = 0:10)\n```\n\n::: {.cell-output-display}\n![](08-analisis-estadisticos_files/figure-pdf/unnamed-chunk-29-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n### Estudios inferenciales\n\n#### Test de normalidad de Shapiro-Wilks\n\n**Objetivo**: Comprobar la normalidad de la distribución de cada\npoblación.\n\n**Hipótesis nula**: La distribución es normal.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-30_b6c3ee956fdfbd9481ed74515fc55c13'}\n\n```{.r .cell-code}\ndf %>% group_by(sexo) %>% \n  summarise(`Estadístico W` = shapiro.test(notaA)$statistic, `p-valor` = shapiro.test(notaA)$p.value)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 x 3\n  sexo   `Estadístico W` `p-valor`\n  <chr>            <dbl>     <dbl>\n1 Hombre           0.990     0.872\n2 Mujer            0.990     0.942\n```\n:::\n:::\n\n\n\n#### Test F de Fisher de comparación de varianzas de dos poblaciones independientes\n\n**Objetivo**: Comparar las varianzas de dos poblaciones independientes.\n\n**Requisitos**:\n\n-   Variable dependiente cuantitativa.\n-   Una variable independiente cualitativa con dos categorías\n    (poblaciones)\n-   Distribución normal de la variable dependiente en ambas poblaciones\n    o tamaños de las muestras de cada población ≥ 30.\n\n**Hipótesis nula**: La varianzas poblacionales son iguales (no existe\nuna diferencia significativa entre las medias poblacionales).\n\n**Ejemplo**: Comprobar si diferencias signicativas entre las notas\nmedias de hombres y mujeres.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-31_eb56f9e9f7e7e71e18d081281da42221'}\n\n```{.r .cell-code}\n# Test de comparación de varianzas\nvar.test(notaA ~ sexo, data = df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tF test to compare two variances\n\ndata:  notaA by sexo\nF = 0.6769, num df = 70, denom df = 48, p-value = 0.1347\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.3953421 1.1293155\nsample estimates:\nratio of variances \n         0.6769032 \n```\n:::\n:::\n\n\n\n#### Test t de comparación de medias de dos poblaciones independientes\n\n**Objetivo**: Estimar la diferencia de medias en las dos poblaciones o\ncomprobar si hay diferencias significativas entre ellas.\n\n**Requisitos**:\n\n-   Variable dependiente cuantitativa.\n-   Una variable independiente cualitativa con dos categorías\n    (poblaciones)\n-   Distribución normal de la variable dependiente en ambas poblaciones\n    o tamaños de las muestras de cada población ≥ 30.\n\n**Hipótesis nula**: La medias poblacionales son iguales (no existe una\ndiferencia significativa entre las medias poblacionales).\n\n**Observación**: El resultado del test depende de si las varianzas\npoblacionales son iguales o no.\n\n**Ejemplo**: Comprobar si diferencias signicativas entre las notas\nmedias de hombres y mujeres.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-32_839031cfe9fd3586fa7eaae2353762ef'}\n\n```{.r .cell-code}\n# Test de comparación de varianzas\nvar.test(notaA ~ sexo, data = df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tF test to compare two variances\n\ndata:  notaA by sexo\nF = 0.6769, num df = 70, denom df = 48, p-value = 0.1347\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.3953421 1.1293155\nsample estimates:\nratio of variances \n         0.6769032 \n```\n:::\n:::\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-33_65beae8969692b5fc2dbf7494ac8bec1'}\n\n```{.r .cell-code}\n# Test de comparación de medias asumiendo varianzas iguales\nt.test (notaA ~ sexo, data = df, alternative = \"two.sided\", var.equal = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  notaA by sexo\nt = 0.89364, df = 89.873, p-value = 0.3739\nalternative hypothesis: true difference in means between group Hombre and group Mujer is not equal to 0\n95 percent confidence interval:\n -0.2821809  0.7435779\nsample estimates:\nmean in group Hombre  mean in group Mujer \n            6.122535             5.891837 \n```\n:::\n:::\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-34_d2e9db048cc9b7c37f610326fe4c88c3'}\n\n```{.r .cell-code}\n# Test de comparación de medias asumiendo varianzas iguales\nt.test (notaA ~ sexo, data = df, alternative = \"two.sided\", var.equal = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tTwo Sample t-test\n\ndata:  notaA by sexo\nt = 0.92608, df = 118, p-value = 0.3563\nalternative hypothesis: true difference in means between group Hombre and group Mujer is not equal to 0\n95 percent confidence interval:\n -0.262615  0.724012\nsample estimates:\nmean in group Hombre  mean in group Mujer \n            6.122535             5.891837 \n```\n:::\n:::\n\n\n\n-   Diagrama de medias\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-35_21d8482b558daaea9e9655408104f839'}\n\n```{.r .cell-code}\ndf %>% ggplot(aes(x = sexo, y = notaA, colour = sexo)) + \n  # Puntos de medias\n  stat_summary(fun=\"mean\", size=3,  geom=\"point\", position=position_dodge(width=0.25)) + \n  # Intervalos de confianza para la media\n  stat_summary(fun.data = function(x) mean_cl_normal(x, conf.int=0.95), geom = \"pointrange\", position=position_dodge(width=0.25)) \n```\n\n::: {.cell-output-display}\n![](08-analisis-estadisticos_files/figure-pdf/unnamed-chunk-35-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n#### Test U de Mann-Whitney de comparación de dos poblaciones independientes (no paramétrico)\n\n**Objetivo**: Comprobar si hay diferencias significativas entre entre\ndos poblaciones independientes.\n\n**Requisitos**:\n\n-   Variable dependiente cuantitativa.\n-   Una variable independiente cualitativa con dos categorías\n    (poblaciones)\n\n**Hipótesis nula**: La medianas poblacionales son iguales (no existe una\ndiferencia significativa entre las medianas poblacionales).\n\n**Ejemplo**: Comprobar si diferencias signicativas entre las notas de\nhombres y mujeres.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-36_90a6c2d0361b193d5f9175808002dd92'}\n\n```{.r .cell-code}\n# Test de rangos U the Mann-Whitney\nwilcox.test(notaA ~ sexo, data = df, alternative = \"two.sided\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon rank sum test with continuity correction\n\ndata:  notaA by sexo\nW = 1917, p-value = 0.3445\nalternative hypothesis: true location shift is not equal to 0\n```\n:::\n:::\n\n\n\n\n## Dos variables: Variable dependiente cuantitativa y variable independiente culitativa con dos categorías o grupos pareados\n\nDos grupos o poblaciones están pareadas o emparejadas cuando los dos\npoblaciones contienen los mismos individuos, es decir, se trata en\nrealidadad de una única población, pero la variable dependiente se mide\ndos veces en cada individuo (normalmente antes y después de la algún\nsuceso) y por tanto cada individuo tiene asociado un par de valores.\n\nEste estudio puede realizarse también creando una nueva variable a\npartir de la resta de las dos mediciones y planteando un estudio de una\nsola variable cuantitativa.\n\n**Ejemplo**: Creación de la diferencia de notas de las asignaturas A y\nB.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-37_eadb4cdf14a9ec936af0879ce6a7d197'}\n\n```{.r .cell-code}\n# Creamos la variable diferencia = notaA - notaB\ndf <- df %>% mutate(diferencia = notaA - notaB)\n```\n:::\n\n\n\n### Estudios descriptivos\n\n#### Estadísticos\n\n-   Tamaño muestral del grupo\n-   Media de la diferencia\n-   Desviación típica de la diferencia\n-   Mínimo, Máximo de la diferencia\n-   Cuartiles de la diferencia\n-   Coeficiente de asimetría de la diferencia\n-   Coeficiente de apuntamiento de la diferencia\n\n**Ejemplo**: Estadísticos descriptivos de la diferencia entre las notas\nde las asignaturas A y B de un mismo grupo de alumnos.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-38_a0cc975ea79038444429d1e9735b9108'}\n\n```{.r .cell-code}\n# Tamaño muestral de sin contar los datos perdidos\nlength(na.omit(df$diferencia))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 115\n```\n:::\n:::\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-39_79a740ede36b2066ab02a64208f8c27f'}\n\n```{.r .cell-code}\n# Media, Desviación típica, Mín, Máx, Cuartiles, Coef. Asimetría y Coef. Apuntamiento\nlibrary(moments)\ndf %>% summarize(Media = mean(diferencia, na.rm=TRUE), Des.Tip = sd(diferencia, na.rm = TRUE), Mín = min(diferencia, na.rm = TRUE), Máx = max(diferencia, na.rm = TRUE), C1 = quantile(diferencia, 0.25, na.rm = TRUE), C2 = quantile(diferencia, 0.5, na.rm = TRUE), C3 = quantile(diferencia, 0.75, na.rm = TRUE), Coef.Asimetría = skewness(diferencia, na.rm = TRUE), Coef.Apuntamiento = kurtosis(diferencia, na.rm = TRUE) - 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       Media   Des.Tip  Mín Máx   C1   C2   C3 Coef.Asimetría Coef.Apuntamiento\n1 -0.8817391 0.9000568 -3.2 1.1 -1.5 -0.8 -0.3     -0.4304152        -0.1366944\n```\n:::\n:::\n\n\n\n#### Gráficos\n\n-   Diagrama de cajas y bigotes\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-40_d9c96eb2acff68334227c4be59805635'}\n\n```{.r .cell-code}\ndf %>% ggplot(aes(x = diferencia)) + \n  geom_boxplot(fill=\"#00BFC4\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 5 rows containing non-finite values (`stat_boxplot()`).\n```\n:::\n\n::: {.cell-output-display}\n![](08-analisis-estadisticos_files/figure-pdf/unnamed-chunk-40-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n### Estudios inferenciales\n\n#### Test de normalidad de Shapiro-Wilks\n\n**Objetivo**: Comprobar la normalidad de la distribución de la\ndiferencia.\n\n**Hipótesis nula**: La distribución es normal.\n\n**Ejemplo**: Comprobar la normalidad de la diferencia entre las notas de\nlas asignaturas A y B de un mismo grupo de alumnos.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-41_15873fb7732c80816d6b2f558b71c49c'}\n\n```{.r .cell-code}\ndf %>% summarise(`Estadístico W` = shapiro.test(diferencia)$statistic, `p-valor` = shapiro.test(diferencia)$p.value)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Estadístico W    p-valor\n1     0.9794023 0.07367451\n```\n:::\n:::\n\n\n\n#### Test t de comparación de medias de dos poblaciones pareadas\n\n**Objetivo**: Estimar la media de la diferencia o compararla con un\nvalor dado *μ*<sub>0</sub>.\n\n**Requisitos**:\n\n-   Variable dependiente cuantitativa.\n-   Una variable independiente cualitativa con dos categorías\n    (poblaciones) pareadas\n-   Distribución normal de la variable diferencia o tamaño muestral\n    ≥ 30.\n\n**Hipótesis nula**: La medias poblacionales son iguales (no existe una\ndiferencia significativa entre las medias poblacionales).\n\n**Ejemplo**: Comprobar si hay una diferencia signicativa entre las notas\nmedias de las asinaturas A y B, o lo que es lo mismo, comprobar si la\nmedia de la diferencia de las notas de A y B es distinta de 0.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-42_917532f6b386f7f7cf04eee9fcf86899'}\n\n```{.r .cell-code}\nt.test (df$notaA, df$notaB, alternative = \"two.sided\", paired = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPaired t-test\n\ndata:  df$notaA and df$notaB\nt = -10.506, df = 114, p-value < 2.2e-16\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n -1.048005 -0.715473\nsample estimates:\nmean difference \n     -0.8817391 \n```\n:::\n:::\n\n\n\n-   Diagrama de medias\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-43_8e99e0641b6b88af4024273e03e6af77'}\n\n```{.r .cell-code}\ndf %>% ggplot(aes(x=\"\", y = diferencia)) + \n  # Puntos de medias\n  stat_summary(fun=\"mean\", size=3,  geom=\"point\") + \n  # Intervalos de confianza para la media\n  stat_summary(fun.data = function(x) mean_cl_normal(x, conf.int=0.95), geom = \"pointrange\", position=position_dodge(width=0.25)) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 5 rows containing non-finite values (`stat_summary()`).\nRemoved 5 rows containing non-finite values (`stat_summary()`).\n```\n:::\n\n::: {.cell-output-display}\n![](08-analisis-estadisticos_files/figure-pdf/unnamed-chunk-43-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n#### Test Wilcoxon de comparación de dos poblaciones pareadas (no paramétrico)\n\n**Objetivo**: Comparar las medianas de las dos poblaciones.\n\n**Requisitos**:\n\n-   Variable dependiente cuantitativa.\n-   Una variable independiente cualitativa con dos categorías\n    (poblaciones) pareadas.\n\n**Hipótesis nula**: La medianas poblacionales son iguales (no existe una\ndiferencia significativa entre las medianas poblacionales).\n\n**Ejemplo**: Comprobar si hay una diferencia signicativa entre las notas\nde las asignaturas A y B.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-44_94125119e23efbef609b790a909ebf06'}\n\n```{.r .cell-code}\nwilcox.test(df$notaA, df$notaB, alternative = \"two.sided\", paired = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  df$notaA and df$notaB\nV = 398, p-value = 2.442e-15\nalternative hypothesis: true location shift is not equal to 0\n```\n:::\n:::\n\n\n\n## Dos variables: Variable dependiente cuantitativa y variable independiente culitativa con más de dos categorías o grupos\n\n### Estudios descriptivos\n\n#### Estadísticos\n\n-   Tamaño muestral de cada grupo\n-   Media de cada grupo\n-   Desviación típica de cada grupo\n-   Mínimo, Máximo de cada grupo\n-   Cuartiles de cada grupo\n-   Coeficiente de asimetría de cada grupo\n-   Coeficiente de apuntamiento de cada grupo\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-45_b4305fb38fa11cf1592091395f1cd4bc'}\n\n```{.r .cell-code}\n# Tamaño muestral de notaA según el grupo\ndf %>% group_by(grupo) %>% group_size()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 38 35 47\n```\n:::\n:::\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-46_086b8d2b07b480f34f5484f885190b13'}\n\n```{.r .cell-code}\n# Media, Desviación típica, Mín, Máx, Cuartiles, Coef. Asimetría y Coef. Apuntamiento\nlibrary(moments)\ndf %>% group_by(grupo) %>% summarize(Media = mean(notaA, na.rm=TRUE), Des.Tip = sd(notaA, na.rm = TRUE), Mín = min(notaA, na.rm = TRUE), Máx = max(notaA, na.rm = TRUE), C1 = quantile(notaA, 0.25, na.rm = TRUE), C2 = quantile(notaA, 0.5, na.rm = TRUE), C3 = quantile(notaA, 0.75, na.rm = TRUE), Coef.Asimetría = skewness(notaA, na.rm = TRUE), Coef.Apuntamiento = kurtosis(notaA, na.rm = TRUE) - 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 x 10\n  grupo Media Des.Tip   Mín   Máx    C1    C2    C3 Coef.Asimetría\n  <chr> <dbl>   <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>          <dbl>\n1 A      6.54   0.998   4.3   8.6  5.93   6.6  7.15         -0.250\n2 B      6.96   1.23    3.5   9.3  6.2    6.8  7.7          -0.141\n3 C      4.92   0.771   2.5   5.9  4.5    5.1  5.5          -1.06 \n# i 1 more variable: Coef.Apuntamiento <dbl>\n```\n:::\n:::\n\n\n\n#### Gráficos\n\n-   Diagrama de cajas y bigotes\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-47_74b0f5c23afa6626e27e0a8f8c82ba5d'}\n\n```{.r .cell-code}\ndf %>% ggplot(aes(x = grupo, y = notaA, fill = grupo)) + \n  geom_boxplot() +\n  # Cambio de escala del eje X\n  scale_y_continuous(limits=c(0, 10), breaks = 0:10)\n```\n\n::: {.cell-output-display}\n![](08-analisis-estadisticos_files/figure-pdf/unnamed-chunk-47-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n-   Diagrama de violín\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-48_9ed466433828b8501179547c9f0a5b09'}\n\n```{.r .cell-code}\ndf %>% ggplot(aes(x = grupo, y = notaA, fill = grupo)) + \n  geom_violin() +\n  # Cambio de escala del eje X\n  scale_y_continuous(limits=c(0, 10), breaks = 0:10)\n```\n\n::: {.cell-output-display}\n![](08-analisis-estadisticos_files/figure-pdf/unnamed-chunk-48-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n### Estudios inferenciales\n\n#### Test de normalidad de Shapiro-Wilks\n\n**Objetivo**: Comprobar la normalidad de la distribución de cada\npoblación.\n\n**Hipótesis nula**: La distribución es normal.\n\n**Ejemplo**: Comprobar la normalidad de las distribuciones de la nota A\nen los grupos A, B y C.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-49_57fa1a253c718d6aa32e2c26824ce871'}\n\n```{.r .cell-code}\ndf %>% group_by(grupo) %>% \n  summarise(`Estadístico W` = shapiro.test(notaA)$statistic, `p-valor` = shapiro.test(notaA)$p.value)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 x 3\n  grupo `Estadístico W` `p-valor`\n  <chr>           <dbl>     <dbl>\n1 A               0.984   0.840  \n2 B               0.963   0.277  \n3 C               0.918   0.00280\n```\n:::\n:::\n\n\n\n**Interpretación**: La distribución de la nota A en los grupos A y B es\nnormal (p-valores > 0.05) pero no en el grupo C (p-valor < 0.05)\n\n**Ejemplo**: Comprobar la normalidad de las distribuciones de la nota C\nen los grupos A, B y C.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-50_be7e15eb0df1969ea24ed77502de0e8e'}\n\n```{.r .cell-code}\ndf %>% group_by(grupo) %>% \n  summarise(`Estadístico W` = shapiro.test(notaC)$statistic, `p-valor` = shapiro.test(notaC)$p.value)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 x 3\n  grupo `Estadístico W` `p-valor`\n  <chr>           <dbl>     <dbl>\n1 A               0.989     0.961\n2 B               0.965     0.343\n3 C               0.976     0.442\n```\n:::\n:::\n\n\n\n**Interpretación**: La distribución de la nota C en los tres grupos es\nnormal (p-valores > 0.05).\n\n#### Test de Levene de comparación de varianzas de dos o más poblaciones independientes\n\n**Objetivo**: Comparar las varianzas de dos o más poblaciones\nindependientes.\n\n**Requisitos**:\n\n-   Variable dependiente cuantitativa.\n-   Una variable independiente cualitativa con dos o más categorías\n    (poblaciones)\n-   Distribución normal de la variable dependiente en todas las\n    poblaciones o tamaños de las muestras de cada población ≥ 30.\n\n**Hipótesis nula**: La varianzas poblacionales son iguales (no existe\nuna diferencia significativa entre las medias poblacionales).\n\n**Ejemplo**: Comprobar si diferencias signicativas entre las varianzas\nde las notas de la asignatura C de los grupos A, B y C.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-51_3e2050e4e21b39ad251a10fe85091720'}\n\n```{.r .cell-code}\n# El test de Levene está disponible en el paquete car\nlibrary(car)\n# Test de comparación de varianzas\nleveneTest(notaC ~ grupo, data = df)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in leveneTest.default(y = y, group = group, ...): group coerced to\nfactor.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nLevene's Test for Homogeneity of Variance (center = median)\n       Df F value Pr(>F)\ngroup   2  0.3186 0.7278\n      116               \n```\n:::\n:::\n\n\n\n**Interpretación**: No existe diferencia significativa entre las\nvarianzas de la nota C en los grupos A, B y C (p-valor > 0.05).\n\n#### ANOVA de un factor para la comparación medias de más de dos poblaciones independientes\n\n**Objetivo**: Comprobar si hay diferencias significativas entre las\nmedias de más de dos poblaciones independientes.\n\n**Requisitos**:\n\n-   Variable dependiente cuantitativa.\n-   Una variable independiente cualitativa con más de dos categorías\n    (poblaciones)-\n-   Distribución normal de la variable dependiente en todas las\n    poblaciones o tamaños de las muestras de cada población ≥ 30.\n-   Homogeneidad de varianzas en las poblaciones.\n\n**Hipótesis nula**: La medias poblacionales son iguales (no existe una\ndiferencia significativa entre las medias poblacionales).\n\n**Ejemplo**: Comprobar si diferencias signicativas entre las notas\nmedias de la asignatura C de los grupos A, B y C.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-52_0c43fcc5d3f1ff4a0c46dd6823322447'}\n\n```{.r .cell-code}\n# Análisis de la varianza de un factor\nsummary(aov(notaC ~ grupo, data = df))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Df Sum Sq Mean Sq F value   Pr(>F)    \ngrupo         2  80.69   40.34   20.05 3.32e-08 ***\nResiduals   116 233.41    2.01                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n1 observation deleted due to missingness\n```\n:::\n:::\n\n\n\n**Interpretación**: Existen diferencias significativas entre las medias\nde la nota C entre al menos dos grupos (p-valor=3.32e-08 < 0.05).\n\n**Observación**: Cuando se detectan diferencias significativas entre las\nmedias de al menos dos grupos conviene realizar un test de comparación\nmúltiple por pares para ver entre qué poblaciones hay diferencias y\nentre cuáles no. Los test más habituales de comparación por pares son el\nde Tukey y el de Bonferroni.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-53_c510aa95b60cd372d5baeed8385b2cdf'}\n\n```{.r .cell-code}\n# Test de comparación múltiple de Tukey\nTukeyHSD(aov(notaC ~ grupo, data = df))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = notaC ~ grupo, data = df)\n\n$grupo\n          diff        lwr        upr     p adj\nB-A  0.4312693 -0.3637573  1.2262960 0.4048482\nC-A -1.4455767 -2.1802858 -0.7108676 0.0000241\nC-B -1.8768461 -2.6350758 -1.1186163 0.0000001\n```\n:::\n:::\n\n\n\n**Interpretación**: No existe una diferencia significativa entre las\nnotas medias de la asignatura C de los grupos A y B (p-valor=0.4048 >\n0.05), pero si existe una diferencia significativa entre las notas\nmedias de los grupos A y C (p-valor=0.00002 < 0.05) y también entre las\nnotas medias de los grupos B y C (p-valor=0.0000001 < 0.05).\n\n-   Diagrama de medias\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-54_6a35181b1a023ba2cd59fd73911d81e7'}\n\n```{.r .cell-code}\ndf %>% ggplot(aes(x = grupo, y = notaC, colour = grupo)) + \n  # Puntos de medias\n  stat_summary(fun=\"mean\", size=3,  geom=\"point\", position=position_dodge(width=0.25)) + \n  # Intervalos de confianza para la media\n  stat_summary(fun.data = function(x) mean_cl_normal(x, conf.int=0.95), geom = \"pointrange\", position=position_dodge(width=0.25)) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 1 rows containing non-finite values (`stat_summary()`).\nRemoved 1 rows containing non-finite values (`stat_summary()`).\n```\n:::\n\n::: {.cell-output-display}\n![](08-analisis-estadisticos_files/figure-pdf/unnamed-chunk-54-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n#### Test Kruskal-Wallis de comparación de más de dos poblaciones independientes (no paramétrico)\n\n**Objetivo**: Comprobar si hay diferencias significativas entre entre\nmás de dos poblaciones independientes.\n\n**Requisitos**:\n\n-   Variable dependiente cuantitativa.\n-   Una variable independiente cualitativa con más de dos categorías\n    (poblaciones)\n\n**Hipótesis nula**: La medianas poblacionales son iguales (no existe una\ndiferencia significativa entre las medianas poblacionales).\n\n**Ejemplo**: Comprobar si diferencias signicativas entre las notas de la\nasignatura A de los grupos A, B y C.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-55_7ed3c9e41ecd74f9622638e8b489145a'}\n\n```{.r .cell-code}\n# Test de Kruskal-Wallis\nkruskal.test(notaA ~ grupo, data = df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  notaA by grupo\nKruskal-Wallis chi-squared = 62.218, df = 2, p-value = 3.087e-14\n```\n:::\n:::\n\n\n\n**Interpretación**: Existen diferencias significativas entre las notas\nde la asignatura A de al menos dos de los grupos.\n\n**Observación**: Cuando se detectan diferencias significativas entre al\nmenos dos grupos conviene realizar un test de comparación múltiple por\npares para ver entre qué poblaciones hay diferencias y entre cuáles no.\nEl test más habitual es el de Wilcoxon.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-56_c8cda22065bc4621fc36ac155e6c308b'}\n\n```{.r .cell-code}\n# Test de comparación múltiple de Wilcoxon\npairwise.wilcox.test(df$notaA, df$grupo, p.adjust.method = \"BH\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\n\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\n\nWarning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute\nexact p-value with ties\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPairwise comparisons using Wilcoxon rank sum test with continuity correction \n\ndata:  df$notaA and df$grupo \n\n  A       B      \nB 0.19    -      \nC 4.2e-10 1.3e-11\n\nP value adjustment method: BH \n```\n:::\n:::\n\n\n\n**Interpretación**: No existe una diferencia significativa entre las\nnotas de la asignatura A de los grupos A y B (p-valor=0.19 > 0.05),\npero si existe una diferencia significativa entre las notas de los\ngrupos A y C (p-valor=4.2e-10 < 0.05) y también entre las notas de los\ngrupos B y C (p-valor=1.3e-11 < 0.05).\n\n## Dos variables: Variable dependiente cuantitativa y variable independiente cuantitativa\n\n### Estudios descriptivos\n\n#### Estadísticos\n\n#### Estadísticos\n\n-   Tamaño muestral de cada grupo\n-   Media de cada variable\n-   Desviación típica de cada variable\n-   Mínimo, Máximo de cada variable\n-   Cuartiles de cada variable\n-   Coeficiente de asimetría de cada variable\n-   Coeficiente de apuntamiento de cada variable\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-57_846f6f3647f22c15ed7032d47dede896'}\n\n```{.r .cell-code}\n# Tamaño muestral de notaA según el grupo\nnrow(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 120\n```\n:::\n:::\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-58_9170c81a70fdcafe24646db3e2bddbfa'}\n\n```{.r .cell-code}\n# Media, Desviación típica, Mín, Máx, Cuartiles, Coef. Asimetría y Coef. Apuntamiento\nlibrary(moments)\ndf %>% summarize(Media = mean(notaA, na.rm=TRUE), Des.Tip = sd(notaA, na.rm = TRUE), Mín = min(notaA, na.rm = TRUE), Máx = max(notaA, na.rm = TRUE), C1 = quantile(notaA, 0.25, na.rm = TRUE), C2 = quantile(notaA, 0.5, na.rm = TRUE), C3 = quantile(notaA, 0.75, na.rm = TRUE), Coef.Asimetría = skewness(notaA, na.rm = TRUE), Coef.Apuntamiento = kurtosis(notaA, na.rm = TRUE) - 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Media  Des.Tip Mín Máx  C1  C2    C3 Coef.Asimetría Coef.Apuntamiento\n1 6.028333 1.340524 2.5 9.3 5.1 5.9 6.825      0.1373915         -0.102287\n```\n:::\n:::\n\n\n\n#### Gráficos\n\n-   Diagrama de dispersión\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-59_05a49e6e4f90aae4ef18c745e6e178c3'}\n\n```{.r .cell-code}\ndf %>% ggplot(aes(x = notaA, y = notaB)) + \n  geom_point()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 5 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](08-analisis-estadisticos_files/figure-pdf/unnamed-chunk-59-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n### Estudios inferenciales\n\n#### Análisis de regresión\n\n**Objetivo**: Construir un modelo matemático $y=f(x)$ que explique lo mejor posible la variable dependiente en función de la independiente, para utilizarlo con fines predictivos.\n\n**Requisitos**:\n\n-   Variable dependiente cuantitativa.\n-   Una variable independiente cuantitativa.\n\n**Ejemplo**: Construir el modelo lineal (recta de regresión) que mejor explica la relación entre la nota B y la nota A.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-60_0d68e7506d1c1c77c3075503bb33316f'}\n\n```{.r .cell-code}\n# Análisis de la varianza de un factor\nlm(notaB ~ notaA, data = df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = notaB ~ notaA, data = df)\n\nCoefficients:\n(Intercept)        notaA  \n     1.0224       0.9763  \n```\n:::\n:::\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-61_3446c9611ff3122b455e8ca809719f5c'}\n\n```{.r .cell-code}\n# Análisis de la varianza de un factor\nsummary(lm(notaB ~ notaA, data = df))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = notaB ~ notaA, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.99907 -0.59551 -0.07534  0.61398  2.31991 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  1.02243    0.40254    2.54   0.0124 *  \nnotaA        0.97628    0.06637   14.71   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.9035 on 113 degrees of freedom\n  (5 observations deleted due to missingness)\nMultiple R-squared:  0.6569,\tAdjusted R-squared:  0.6539 \nF-statistic: 216.3 on 1 and 113 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n\n**Interpretación**: La recta de regresión explica el 65% de la variabilidad de la nota B.\n\n#### Análisis de correlación\n\n**Objetivo**: Estudiar el grado de relación entre las dos variables.\n\n**Requisitos**:\n\n-   Variable dependiente cuantitativa.\n-   Una variable independiente cuantitativa.\n\n**Hipótesis nula**: Las dos variables son independientes.\n\n**Ejemplo**: Ver si las notas A y B están relacionadas y cuál es su grado de relación.\n\n\n\n::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-62_2ba1fd3462760aab6d54a211a7cfd5be'}\n\n```{.r .cell-code}\n# Análisis de la varianza de un factor\ncor.test(df$notaA, df$notaB)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's product-moment correlation\n\ndata:  df$notaA and df$notaB\nt = 14.709, df = 113, p-value < 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.7367182 0.8651991\nsample estimates:\n      cor \n0.8104926 \n```\n:::\n:::\n\n\n\n**Interpretación**: Existe una correlación fuerte entre la nota A y la nota C, que además es estadísticamente muy significativa.\n\n## Ejercicios\n\n:::{#exr-analisis-estadisticos-1}\nEl fichero [`genetica`](https://raw.githubusercontent.com/asalber/manual-r/master/datos/genetica.csv), contiene información de la análitica fisiológica, microbiológica y bioquímica, de una muestra de ratas tratadas con distintos tratamientos.\n\na.  Crear un tibble con los datos del fichero.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Solución \n\n\n    ::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-63_b39ef73b4fea07ab4df6479664a5a871'}\n    \n    ```{.r .cell-code}\n    library(tidyverse)\n    df <- read_csv('https://raw.githubusercontent.com/asalber/manual-r/master/datos/genetica.csv')\n    df\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    # A tibble: 21 x 20\n       `código muestra` Tratamiento  `mas cor (g)`    IHS     IES     ITS     IAS\n       <chr>            <chr>                <dbl>  <dbl>   <dbl>   <dbl>   <dbl>\n     1 Ct-A1            Control               236  0.0433 0.00198 0.00178 0.00043\n     2 Ct-A2            Control               202. 0.044  0.002   0.0017  0.0008 \n     3 Ct-B1            Control               246. 0.042  0.002   0.0015  0.0005 \n     4 Ct-B2            Control               237. 0.0475 0.00238 0.00203 0.00041\n     5 Ct-B3            Control               231. 0.0499 0.002   0.0011  0.0005 \n     6 Ct-C1            Control               235. 0.05   0.0021  0.0033  0.0014 \n     7 Ct-C2            Control               228. 0.05   0.0018  0.0031  0.00059\n     8 Dx-1             Dexametasona          181. 0.061  0.00155 0.0005  0.00012\n     9 Dx-2             Dexametasona          198. 0.063  0.00191 0.0011  0.0002 \n    10 Dx-3             Dexametasona          201. 0.0577 0.0017  0.0001  0.0001 \n    # i 11 more rows\n    # i 13 more variables: `glucog(mg/g)` <dbl>, `pbmc(cel/mL)` <dbl>,\n    #   `CD4(cel/µL)` <dbl>, `monoc(cel/mL)` <dbl>, `IHQ: linfB(cel/mm2)` <dbl>,\n    #   `pulp.blan(Tx1)` <dbl>, `microorg(log nº/g)` <dbl>, `AI2(absorb)` <dbl>,\n    #   `gluc(mmol/L)` <dbl>, `TAG(mmol/L)` <dbl>, `col(mmol/L)` <dbl>,\n    #   `HDL(mmol/L)` <dbl>, `ins(pmol/L)` <dbl>\n    ```\n    :::\n    :::\n\n\n    :::\n\na.  Convertir el tratamiento en un factor.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Solución \n\n\n    ::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-64_9bc76c207814dcd3a6bb759f85d5f933'}\n    \n    ```{.r .cell-code}\n    df <- mutate(df, Tratamiento = factor(Tratamiento))\n    ```\n    :::\n\n\n    :::\n\na.  Calcular el tamaño muestral de cada grupo de tratamiento\n\n    :::{.callout-note collapse=\"true\"}\n    ## Solución \n\n\n    ::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-65_1defc64a9b0fdc17cc036e1d0ab53aa9'}\n    \n    ```{.r .cell-code}\n    count(df, Tratamiento)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    # A tibble: 3 x 2\n      Tratamiento      n\n      <fct>        <int>\n    1 Control          7\n    2 Dexametasona     7\n    3 Kanamicina       7\n    ```\n    :::\n    :::\n\n\n    :::\n\na.  Comprobar la normalidad de la variable IHS en cada grupo de tratamiento.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Solución \n\n\n    ::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-66_742ff9df82cac210aa2d3010bc172e20'}\n    \n    ```{.r .cell-code}\n    df %>% group_by(Tratamiento) %>% \n      summarise(`Estadístico W` = shapiro.test(IHS)$statistic, `p-valor` = shapiro.test(IHS)$p.value)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    # A tibble: 3 x 3\n      Tratamiento  `Estadístico W` `p-valor`\n      <fct>                  <dbl>     <dbl>\n    1 Control                0.837    0.0928\n    2 Dexametasona           0.976    0.939 \n    3 Kanamicina             0.908    0.383 \n    ```\n    :::\n    :::\n\n\n    :::\n\na.  Comprobar la homocedasticiad de varianzas de la variable IHS en los tres grupos de tratamiento.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-67_ddb626b29994cce1ee94a5058bcfbe80'}\n    \n    ```{.r .cell-code}\n    # El test de Levene está disponible en el paquete car\n    library(car)\n    # Test de comparación de varianzas\n    leveneTest(IHS ~ Tratamiento, data = df)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Levene's Test for Homogeneity of Variance (center = median)\n          Df F value Pr(>F)\n    group  2  0.1636 0.8503\n          18               \n    ```\n    :::\n    :::\n\n\n    :::\n\na.  Realizar un contraste de ANOVA para comparar las medias de la variable IHS entre los tres grupos de tratamiento.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-68_df2d2c873cfd86b3729afb898af9fae2'}\n    \n    ```{.r .cell-code}\n    # Análisis de la varianza de un factor\n    summary(aov(IHS ~ Tratamiento, data = df))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n                Df    Sum Sq  Mean Sq F value   Pr(>F)    \n    Tratamiento  2 0.0007900 3.95e-04   31.78 1.24e-06 ***\n    Residuals   18 0.0002237 1.24e-05                     \n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n    ```\n    :::\n    :::\n\n\n    :::\n\na.  Realizar los contrastes de comparación de medias de la variable IHS por pares de trataimentos.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-69_5c997d2727c458d955abfcbe5ebd526e'}\n    \n    ```{.r .cell-code}\n    # Test de comparación múltiple de Tukey\n    TukeyHSD(aov(IHS ~ Tratamiento, data = df))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n      Tukey multiple comparisons of means\n        95% family-wise confidence level\n    \n    Fit: aov(formula = IHS ~ Tratamiento, data = df)\n    \n    $Tratamiento\n                                     diff          lwr          upr     p adj\n    Dexametasona-Control     0.0133857143  0.008576441  0.018194988 0.0000037\n    Kanamicina-Control       0.0007857143 -0.004023559  0.005594988 0.9090945\n    Kanamicina-Dexametasona -0.0126000000 -0.017409273 -0.007790727 0.0000082\n    ```\n    :::\n    :::\n\n\n    :::\n\na.  Realizar un contraste de Kruskal-Wallis para ver si hay diferencias significativas en la variable IHS entre los tres grupos de tratamiento.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-70_21bad71c06e4a4526ef0ec2f915b7f5a'}\n    \n    ```{.r .cell-code}\n    # Test de Kruskal-Wallis\n    kruskal.test(IHS ~ Tratamiento, data = df)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    \n    \tKruskal-Wallis rank sum test\n    \n    data:  IHS by Tratamiento\n    Kruskal-Wallis chi-squared = 13.433, df = 2, p-value = 0.001211\n    ```\n    :::\n    :::\n\n\n    :::\n\na.  Construir la recta de regresión del variable IHS sobre la variable IES.\n\n    :::{.callout-note collapse=\"true\"}\n    ## Solución\n\n\n    ::: {.cell hash='08-analisis-estadisticos_cache/pdf/unnamed-chunk-71_9b027b8cabba0367509c89d5aabd4d2b'}\n    \n    ```{.r .cell-code}\n    # Test de Kruskal-Wallis\n    lm(IHS ~ IES, data = df)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    \n    Call:\n    lm(formula = IHS ~ IES, data = df)\n    \n    Coefficients:\n    (Intercept)          IES  \n        0.08266    -15.97510  \n    ```\n    :::\n    \n    ```{.r .cell-code}\n    summary(lm(IHS ~ IES, data = df))\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    \n    Call:\n    lm(formula = IHS ~ IES, data = df)\n    \n    Residuals:\n           Min         1Q     Median         3Q        Max \n    -0.0099081 -0.0040654  0.0006222  0.0031102  0.0142492 \n    \n    Coefficients:\n                 Estimate Std. Error t value Pr(>|t|)    \n    (Intercept)   0.08266    0.01470   5.625 2.01e-05 ***\n    IES         -15.97510    7.47347  -2.138   0.0458 *  \n    ---\n    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n    \n    Residual standard error: 0.006558 on 19 degrees of freedom\n    Multiple R-squared:  0.1939,\tAdjusted R-squared:  0.1514 \n    F-statistic: 4.569 on 1 and 19 DF,  p-value: 0.04577\n    ```\n    :::\n    :::\n\n\n    :::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}